{"ast":null,"code":"var _jsxFileName = \"C:\\\\Projects\\\\AI\\\\i8080_GLM5\\\\src\\\\frontend\\\\src\\\\components\\\\TerminalEmulator.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState, useCallback } from 'react';\nimport { Terminal } from 'xterm';\nimport { FitAddon } from 'xterm-addon-fit';\nimport 'xterm/css/xterm.css';\nimport { emulatorApi } from '../services/api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function TerminalEmulator({\n  sessionId,\n  onStatusUpdate\n}) {\n  _s();\n  const terminalRef = useRef(null);\n  const termRef = useRef(null);\n  const fitAddonRef = useRef(null);\n  const [outputBuffer, setOutputBuffer] = useState('');\n  useEffect(() => {\n    if (!terminalRef.current || termRef.current) return;\n    const term = new Terminal({\n      theme: {\n        background: '#0f0f23',\n        foreground: '#00ff00',\n        cursor: '#00ff00',\n        cursorAccent: '#0f0f23',\n        selectionBackground: '#0f3460',\n        black: '#000000',\n        red: '#e94560',\n        green: '#00ff00',\n        yellow: '#ffff00',\n        blue: '#0f3460',\n        magenta: '#e94560',\n        cyan: '#00ffff',\n        white: '#ffffff',\n        brightBlack: '#666666',\n        brightRed: '#ff6b8a',\n        brightGreen: '#00ff00',\n        brightYellow: '#ffff00',\n        brightBlue: '#1a4a7a',\n        brightMagenta: '#ff6b8a',\n        brightCyan: '#00ffff',\n        brightWhite: '#ffffff'\n      },\n      fontFamily: 'Courier New, monospace',\n      fontSize: 14,\n      cursorBlink: true,\n      scrollback: 5000\n    });\n    const fitAddon = new FitAddon();\n    term.loadAddon(fitAddon);\n    term.open(terminalRef.current);\n    setTimeout(() => fitAddon.fit(), 100);\n    termRef.current = term;\n    fitAddonRef.current = fitAddon;\n    term.writeln('\\x1b[1;31m========================================\\x1b[0m');\n    term.writeln('\\x1b[1;31m  Intel 8080 Emulator - CP/M 2.2\\x1b[0m');\n    term.writeln('\\x1b[1;31m========================================\\x1b[0m');\n    term.writeln('');\n    term.writeln('\\x1b[1;33mType HELP for available commands\\x1b[0m');\n    term.writeln('');\n    term.write('A>');\n    const handleResize = () => {\n      fitAddon.fit();\n    };\n    window.addEventListener('resize', handleResize);\n    return () => {\n      window.removeEventListener('resize', handleResize);\n      term.dispose();\n      termRef.current = null;\n    };\n  }, []);\n  const pollOutput = useCallback(async () => {\n    if (!sessionId || !termRef.current) return;\n    try {\n      const status = await emulatorApi.getSessionStatus(sessionId);\n      if (status.output && status.output !== outputBuffer) {\n        const newOutput = status.output.substring(outputBuffer.length);\n        termRef.current.write(newOutput.replace(/\\n/g, '\\r\\n'));\n        setOutputBuffer(status.output);\n        onStatusUpdate === null || onStatusUpdate === void 0 ? void 0 : onStatusUpdate(status);\n      }\n    } catch (e) {\n      console.error('Poll error:', e);\n    }\n  }, [sessionId, outputBuffer, onStatusUpdate]);\n  useEffect(() => {\n    if (!sessionId) return;\n    const interval = setInterval(pollOutput, 200);\n    return () => clearInterval(interval);\n  }, [sessionId, pollOutput]);\n  useEffect(() => {\n    if (!termRef.current || !sessionId) return;\n    let currentLine = '';\n    const disposable = termRef.current.onData(async data => {\n      const code = data.charCodeAt(0);\n      if (code === 13) {\n        termRef.current.writeln('');\n        if (currentLine.trim()) {\n          try {\n            await emulatorApi.sendCommand(sessionId, currentLine);\n          } catch (e) {\n            termRef.current.writeln('\\x1b[1;31mError: ' + e.message + '\\x1b[0m');\n          }\n        }\n        termRef.current.write('A>');\n        currentLine = '';\n      } else if (code === 127 || code === 8) {\n        if (currentLine.length > 0) {\n          currentLine = currentLine.slice(0, -1);\n          termRef.current.write('\\b \\b');\n        }\n      } else if (code >= 32) {\n        currentLine += data;\n        termRef.current.write(data);\n      }\n    });\n    return () => disposable.dispose();\n  }, [sessionId]);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    ref: terminalRef,\n    className: \"terminal-body\"\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 134,\n    columnNumber: 10\n  }, this);\n}\n_s(TerminalEmulator, \"6sFBTaHmXeSt4oo8g0GBafsQlZ0=\");\n_c = TerminalEmulator;\nvar _c;\n$RefreshReg$(_c, \"TerminalEmulator\");","map":{"version":3,"names":["React","useEffect","useRef","useState","useCallback","Terminal","FitAddon","emulatorApi","jsxDEV","_jsxDEV","TerminalEmulator","sessionId","onStatusUpdate","_s","terminalRef","termRef","fitAddonRef","outputBuffer","setOutputBuffer","current","term","theme","background","foreground","cursor","cursorAccent","selectionBackground","black","red","green","yellow","blue","magenta","cyan","white","brightBlack","brightRed","brightGreen","brightYellow","brightBlue","brightMagenta","brightCyan","brightWhite","fontFamily","fontSize","cursorBlink","scrollback","fitAddon","loadAddon","open","setTimeout","fit","writeln","write","handleResize","window","addEventListener","removeEventListener","dispose","pollOutput","status","getSessionStatus","output","newOutput","substring","length","replace","e","console","error","interval","setInterval","clearInterval","currentLine","disposable","onData","data","code","charCodeAt","trim","sendCommand","message","slice","ref","className","fileName","_jsxFileName","lineNumber","columnNumber","_c","$RefreshReg$"],"sources":["C:/Projects/AI/i8080_GLM5/src/frontend/src/components/TerminalEmulator.js"],"sourcesContent":["import React, { useEffect, useRef, useState, useCallback } from 'react';\nimport { Terminal } from 'xterm';\nimport { FitAddon } from 'xterm-addon-fit';\nimport 'xterm/css/xterm.css';\nimport { emulatorApi } from '../services/api';\n\nexport default function TerminalEmulator({ sessionId, onStatusUpdate }) {\n  const terminalRef = useRef(null);\n  const termRef = useRef(null);\n  const fitAddonRef = useRef(null);\n  const [outputBuffer, setOutputBuffer] = useState('');\n  \n  useEffect(() => {\n    if (!terminalRef.current || termRef.current) return;\n    \n    const term = new Terminal({\n      theme: {\n        background: '#0f0f23',\n        foreground: '#00ff00',\n        cursor: '#00ff00',\n        cursorAccent: '#0f0f23',\n        selectionBackground: '#0f3460',\n        black: '#000000',\n        red: '#e94560',\n        green: '#00ff00',\n        yellow: '#ffff00',\n        blue: '#0f3460',\n        magenta: '#e94560',\n        cyan: '#00ffff',\n        white: '#ffffff',\n        brightBlack: '#666666',\n        brightRed: '#ff6b8a',\n        brightGreen: '#00ff00',\n        brightYellow: '#ffff00',\n        brightBlue: '#1a4a7a',\n        brightMagenta: '#ff6b8a',\n        brightCyan: '#00ffff',\n        brightWhite: '#ffffff'\n      },\n      fontFamily: 'Courier New, monospace',\n      fontSize: 14,\n      cursorBlink: true,\n      scrollback: 5000\n    });\n    \n    const fitAddon = new FitAddon();\n    term.loadAddon(fitAddon);\n    term.open(terminalRef.current);\n    \n    setTimeout(() => fitAddon.fit(), 100);\n    \n    termRef.current = term;\n    fitAddonRef.current = fitAddon;\n    \n    term.writeln('\\x1b[1;31m========================================\\x1b[0m');\n    term.writeln('\\x1b[1;31m  Intel 8080 Emulator - CP/M 2.2\\x1b[0m');\n    term.writeln('\\x1b[1;31m========================================\\x1b[0m');\n    term.writeln('');\n    term.writeln('\\x1b[1;33mType HELP for available commands\\x1b[0m');\n    term.writeln('');\n    term.write('A>');\n    \n    const handleResize = () => {\n      fitAddon.fit();\n    };\n    \n    window.addEventListener('resize', handleResize);\n    \n    return () => {\n      window.removeEventListener('resize', handleResize);\n      term.dispose();\n      termRef.current = null;\n    };\n  }, []);\n  \n  const pollOutput = useCallback(async () => {\n    if (!sessionId || !termRef.current) return;\n    \n    try {\n      const status = await emulatorApi.getSessionStatus(sessionId);\n      if (status.output && status.output !== outputBuffer) {\n        const newOutput = status.output.substring(outputBuffer.length);\n        termRef.current.write(newOutput.replace(/\\n/g, '\\r\\n'));\n        setOutputBuffer(status.output);\n        onStatusUpdate?.(status);\n      }\n    } catch (e) {\n      console.error('Poll error:', e);\n    }\n  }, [sessionId, outputBuffer, onStatusUpdate]);\n  \n  useEffect(() => {\n    if (!sessionId) return;\n    \n    const interval = setInterval(pollOutput, 200);\n    return () => clearInterval(interval);\n  }, [sessionId, pollOutput]);\n  \n  useEffect(() => {\n    if (!termRef.current || !sessionId) return;\n    \n    let currentLine = '';\n    \n    const disposable = termRef.current.onData(async (data) => {\n      const code = data.charCodeAt(0);\n      \n      if (code === 13) {\n        termRef.current.writeln('');\n        \n        if (currentLine.trim()) {\n          try {\n            await emulatorApi.sendCommand(sessionId, currentLine);\n          } catch (e) {\n            termRef.current.writeln('\\x1b[1;31mError: ' + e.message + '\\x1b[0m');\n          }\n        }\n        \n        termRef.current.write('A>');\n        currentLine = '';\n      } else if (code === 127 || code === 8) {\n        if (currentLine.length > 0) {\n          currentLine = currentLine.slice(0, -1);\n          termRef.current.write('\\b \\b');\n        }\n      } else if (code >= 32) {\n        currentLine += data;\n        termRef.current.write(data);\n      }\n    });\n    \n    return () => disposable.dispose();\n  }, [sessionId]);\n  \n  return <div ref={terminalRef} className=\"terminal-body\" />;\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}